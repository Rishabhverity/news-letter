[uwsgi]
# Load the Flask app
module = wsgi:app

# Set the environment to production
env = FLASK_ENV=production

# MySQL Database configuration from .env
env = MYSQL_USER=user
env = MYSQL_PASSWORD=password
env = MYSQL_ROOT_PASSWORD=this
env = MYSQL_DB=news
env = MYSQL_HOST=db
env = MYSQL_PORT=3306
env = FLASK_APP=news_letter.py
env = DATABASE_URI=mysql+pymysql://user:password@db/news

# Run uWSGI in master mode with multiple processes and threads
master = true
processes = 4  # Number of worker processes
threads = 2    # Number of threads per worker

# Network configuration
socket = 0.0.0.0:5000
protocol = http

# Enable logging (ensure the path exists and is writable)
logto = /var/log/uwsgi/newsletter.log

# Auto-reload the app when a file is modified (useful during development)
py-autoreload = 1

